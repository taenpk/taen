<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Boy or Girl?</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&family=Pacifico&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root {
            --text-dark: #2C3E50;
            --glass-border: rgba(255, 255, 255, 0.5);
            /* –¢–µ–Ω–∏ –¥–ª—è –æ–±—ä–µ–º–∞ */
            --soft-shadow: 0 10px 25px rgba(163, 177, 198, 0.15); 
            --button-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Nunito', sans-serif;
            /* –û–±—â–∏–π —Ñ–æ–Ω —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–∑–∞ –∫–∞—Ä—Ç–æ—á–∫–æ–π) */
            background: linear-gradient(135deg, #f0f4f8 0%, #d9e2ec 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        /* –ö–∞–Ω–≤–∞—Å –¥–ª—è 3D —Ñ–æ–Ω–∞ */
        #bg-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–ö–ê–†–¢–û–ß–ö–ê) */
        .app-container {
            position: relative;
            z-index: 10;
            
            /* --- –ò–ó–ú–ï–ù–ï–ù–ò–ï: –õ–ï–ì–ö–ò–ô –ì–†–ê–î–ò–ï–ù–¢ –ù–ê –ö–ê–†–¢–û–ß–ö–ï --- */
            background: linear-gradient(145deg, rgba(230, 242, 255, 0.9), rgba(255, 235, 240, 0.9));
            
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            
            width: 90%;
            max-width: 400px;
            min-height: 550px;
            padding: 40px 25px;
            border-radius: 40px;
            box-shadow: var(--soft-shadow);
            
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: height 0.3s ease;
        }

        /* –¢–∏–ø–æ–≥—Ä–∞—Ñ–∏–∫–∞ */
        h1 {
            font-family: 'Pacifico', cursive;
            font-size: 40px;
            /* –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ç–µ–∫—Å—Ç */
            background: linear-gradient(45deg, #4D96FF, #FF8FAB);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 0 0 15px 0;
            line-height: 1.2;
            filter: drop-shadow(0 2px 3px rgba(0,0,0,0.1));
        }

        p {
            font-size: 18px;
            color: #555;
            margin-bottom: 30px;
            line-height: 1.6;
            font-weight: 700;
        }

        /* --- –≠–ö–†–ê–ù 1: –ü–ò–ù –ö–û–î --- */
        .pin-wrapper { width: 100%; }
        
        .pin-display {
            font-size: 42px;
            letter-spacing: 12px;
            font-weight: 900;
            color: var(--text-dark);
            margin-bottom: 30px;
            height: 70px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.05);
        }

        .numpad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            max-width: 320px;
            margin: 0 auto;
        }

        .num-btn {
            /* –ö–Ω–æ–ø–∫–∏ –±–µ–ª—ã–µ, —á—Ç–æ–±—ã –≤—ã–¥–µ–ª—è—Ç—å—Å—è –Ω–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–µ –∫–∞—Ä—Ç–æ—á–∫–∏ */
            background: #ffffff;
            border: none;
            border-radius: 22px;
            height: 65px;
            font-size: 26px;
            font-weight: 800;
            color: var(--text-dark);
            cursor: pointer;
            box-shadow: var(--button-shadow);
            transition: transform 0.1s, box-shadow 0.1s;
        }

        .num-btn:active {
            transform: scale(0.95);
            background: #fcfcfc;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .enter-btn {
            grid-column: span 3;
            background: linear-gradient(90deg, #89CFF0, #FFC8DD);
            color: #fff;
            text-shadow: 0 1px 2px rgba(0,0,0,0.15);
            margin-top: 15px;
            box-shadow: 0 5px 15px rgba(137, 207, 240, 0.4);
        }
        
        .enter-btn:active {
             transform: scale(0.98);
        }

        /* --- –≠–ö–†–ê–ù 2: –í–û–ü–†–û–°–´ --- */
        .quiz-option {
            /* –ë–µ–ª—ã–µ –∫–Ω–æ–ø–∫–∏ –Ω–∞ —Ü–≤–µ—Ç–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–µ */
            background: #ffffff;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 25px;
            width: 100%;
            font-size: 17px;
            font-weight: 800;
            color: var(--text-dark);
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: var(--button-shadow);
            position: relative;
            overflow: hidden;
        }
        
        .quiz-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }

        .quiz-option:active {
            transform: scale(0.98);
            background: #f9f9f9;
        }

        /* --- –≠–ö–†–ê–ù 3: –í–û–ü–†–û–°–ò–ö --- */
        .balloon-container {
            position: relative;
            height: 300px;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .question-mark {
            font-size: 110px;
            font-weight: 900;
            /* –ì—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è –≤–æ–ø—Ä–æ—Å–∏–∫–∞ */
            background: linear-gradient(180deg, #89CFF0 0%, #FFC8DD 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            cursor: pointer;
            transition: transform 0.1s;
            filter: drop-shadow(0 10px 20px rgba(137, 207, 240, 0.4));
            z-index: 5;
        }

        .tap-hint {
            position: absolute;
            bottom: 20px;
            width: 100%;
            text-align: center;
            color: #888;
            font-size: 14px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 2px;
            animation: pulseHint 1.5s infinite;
        }

        @keyframes pulseHint {
            0%, 100% { opacity: 0.5; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.05); }
        }

        /* --- –≠–ö–†–ê–ù 4: –†–ï–ó–£–õ–¨–¢–ê–¢ --- */
        .result-title {
            font-size: 48px;
            font-weight: 900;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: -1px;
        }
        
        .boy-style { color: #4D96FF; text-shadow: 0 5px 15px rgba(77, 150, 255, 0.3); }
        .girl-style { color: #FF8FAB; text-shadow: 0 5px 15px rgba(255, 143, 171, 0.3); }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        .screen {
            display: none;
            width: 100%;
            animation: slideUpFade 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .screen.active { display: block; }

        @keyframes slideUpFade {
            from { opacity: 0; transform: translateY(30px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .shake { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; border: 2px solid #ff6b6b !important; }
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }
    </style>
</head>
<body>

    <canvas id="bg-canvas"></canvas>

    <div class="app-container">
        
        <div id="screen-login" class="screen active">
            <h1>–¢—Å—Å... –°–µ–∫—Ä–µ—Ç!</h1>
            <p>–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å —Ç–∞–π–Ω—É</p>
            
            <div class="pin-wrapper">
                <div class="pin-display" id="pin-display"></div>
                <div class="numpad">
                    <button class="num-btn" onclick="addPin(1)">1</button>
                    <button class="num-btn" onclick="addPin(2)">2</button>
                    <button class="num-btn" onclick="addPin(3)">3</button>
                    <button class="num-btn" onclick="addPin(4)">4</button>
                    <button class="num-btn" onclick="addPin(5)">5</button>
                    <button class="num-btn" onclick="addPin(6)">6</button>
                    <button class="num-btn" onclick="addPin(7)">7</button>
                    <button class="num-btn" onclick="addPin(8)">8</button>
                    <button class="num-btn" onclick="addPin(9)">9</button>
                    <button class="num-btn" style="visibility:hidden"></button>
                    <button class="num-btn" onclick="addPin(0)">0</button>
                    <button class="num-btn" onclick="clearPin()" style="color:#e74c3c">‚å´</button>
                    
                    <button class="num-btn enter-btn" onclick="checkPin()">–í–û–ô–¢–ò</button>
                </div>
            </div>
        </div>

        <div id="screen-quiz" class="screen">
            <p style="text-transform:uppercase; font-size:13px; letter-spacing:2px; color:#888; margin-bottom:10px;">–ò–Ω—Ç—É–∏—Ü–∏—è <span id="q-number">1</span>/3</p>
            <h2 id="question-text" style="font-size:26px; margin-bottom:35px; color: var(--text-dark);">–¢–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞</h2>
            <div id="quiz-options"></div>
        </div>

        <div id="screen-game" class="screen">
            <h1>–ú–æ–º–µ–Ω—Ç –∏—Å—Ç–∏–Ω—ã!</h1>
            <p>–¢–∞–ø–∞–π—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å–∏–∫, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –ø—Ä–∞–≤–¥—É!</p>
            
            <div class="balloon-container">
                <div class="question-mark" id="balloon" onclick="tapBalloon()">?</div>
                <div class="tap-hint">–ù–∞–∂–∏–º–∞–π –±—ã—Å—Ç—Ä–µ–µ!</div>
            </div>
        </div>

        <div id="screen-result" class="screen">
            <h1 id="reveal-text" class="result-title">...</h1>
            <div style="font-size: 100px; margin: 20px 0; filter: drop-shadow(0 10px 20px rgba(0,0,0,0.1));">
                <span id="reveal-icon"></span>
            </div>
            <p>–£—Ä–∞! –ú—ã —Ç–∞–∫ —Å—á–∞—Å—Ç–ª–∏–≤—ã!</p>
            <button class="quiz-option" onclick="location.reload()" style="background:#fff; color:#888; margin-top:30px;">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
        </div>

    </div>

    <script>
        // ==========================================
        // –ù–ê–°–¢–†–û–ô–ö–ò (–ú–ï–ù–Ø–¢–¨ –¢–£–¢)
        // ==========================================
        const ACCESS_PIN = "1234";  // –ü–∞—Ä–æ–ª—å
        const BABY_GENDER = "boy"; // "boy" –∏–ª–∏ "girl"
        // ==========================================

        let pinInput = "";
        let currentQ = 0;
        let taps = 0;
        const requiredTaps = 15; 

        const questions = [
            { t: "–ö–æ–≥–æ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –∂–¥—É—Ç –±–∞–±—É—à–∫–∏?", a: ["–í–Ω—É–∫–∞ ‚öΩ", "–í–Ω—É—á–∫—É üéÄ", "–ì–ª–∞–≤–Ω–æ–µ –∑–¥–æ—Ä–æ–≤–æ–≥–æ! ‚ù§Ô∏è"] },
            { t: "–ö—Ç–æ –±—É–¥–µ—Ç –≤—Å—Ç–∞–≤–∞—Ç—å –ø–æ –Ω–æ—á–∞–º?", a: ["–ü–∞–ø–∞ üò¥", "–ú–∞–º–∞ üçº", "–ü–æ –æ—á–µ—Ä–µ–¥–∏ ü§ù"] },
            { t: "–ù–∞ –∫–æ–≥–æ –±—É–¥–µ—Ç –ø–æ—Ö–æ–∂ –º–∞–ª—ã—à?", a: ["–ù–∞ –ø–∞–ø—É üë®", "–ù–∞ –º–∞–º—É üë©", "–°–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π üòé"] }
        ];

        // --- –õ–û–ì–ò–ö–ê ---
        function addPin(num) {
            if (pinInput.length < 4) {
                pinInput += num;
                updatePinDisplay();
            }
        }
        function clearPin() {
            pinInput = pinInput.slice(0, -1);
            updatePinDisplay();
        }
        function updatePinDisplay() {
            const display = document.getElementById('pin-display');
            display.innerText = "‚Ä¢".repeat(pinInput.length);
            display.classList.remove('shake');
        }
        function checkPin() {
            if (pinInput === ACCESS_PIN) {
                switchScreen('screen-quiz');
                loadQuestion();
            } else {
                const display = document.getElementById('pin-display');
                display.classList.add('shake');
                pinInput = "";
                setTimeout(updatePinDisplay, 400);
            }
        }

        function loadQuestion() {
            const q = questions[currentQ];
            document.getElementById('question-text').innerText = q.t;
            document.getElementById('q-number').innerText = currentQ + 1;
            const cont = document.getElementById('quiz-options');
            cont.innerHTML = '';
            q.a.forEach((ans, index) => {
                const btn = document.createElement('button');
                btn.className = 'quiz-option';
                btn.innerText = ans;
                btn.style.animation = `slideUpFade 0.5s ease forwards ${index * 0.1}s`;
                btn.onclick = nextQuestion;
                cont.appendChild(btn);
            });
        }
        function nextQuestion() {
            currentQ++;
            if (currentQ < questions.length) loadQuestion();
            else switchScreen('screen-game');
        }

        function tapBalloon() {
            taps++;
            const qMark = document.getElementById('balloon');
            if (navigator.vibrate) navigator.vibrate(40);

            const scale = 1 + (taps * 0.15); 
            const rotate = (Math.random() - 0.5) * 30; 
            qMark.style.transform = `scale(${scale}) rotate(${rotate}deg)`;

            // –°–º–µ–Ω–∞ —Ü–≤–µ—Ç–∞ –ø—Ä–∏ —Ç–∞–ø–µ
            if (taps > 5) qMark.style.webkitTextFillColor = "#FFD700"; 
            if (taps > 10) qMark.style.webkitTextFillColor = "#FF6B6B"; 

            if (taps >= requiredTaps) explodeBalloon();
        }

        function explodeBalloon() {
            const qMark = document.getElementById('balloon');
            qMark.style.transition = "transform 0.2s ease, opacity 0.2s ease";
            qMark.style.transform = "scale(3)";
            qMark.style.opacity = "0";
            if (navigator.vibrate) navigator.vibrate([100, 50, 100]);
            setTimeout(showResult, 300);
        }

        function showResult() {
            switchScreen('screen-result');
            const title = document.getElementById('reveal-text');
            const icon = document.getElementById('reveal-icon');
            let colors = [];
            
            if (BABY_GENDER === 'boy') {
                title.innerText = "–≠–¢–û –ú–ê–õ–¨–ß–ò–ö!";
                title.className = "result-title boy-style";
                icon.innerText = "üë∂üíô";
                colors = ['#4D96FF', '#89CFF0', '#FFFFFF'];
            } else {
                title.innerText = "–≠–¢–û –î–ï–í–û–ß–ö–ê!";
                title.className = "result-title girl-style";
                icon.innerText = "üëßüéÄ";
                colors = ['#FF8FAB', '#FFC8DD', '#FFFFFF'];
            }

            const duration = 3000;
            const end = Date.now() + duration;
            (function frame() {
                confetti({ particleCount: 5, angle: 60, spread: 55, origin: { x: 0 }, colors: colors });
                confetti({ particleCount: 5, angle: 120, spread: 55, origin: { x: 1 }, colors: colors });
                if (Date.now() < end) requestAnimationFrame(frame);
            }());
        }

        function switchScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            setTimeout(() => {
                document.getElementById(id).classList.add('active');
            }, 50);
        }

        // ==========================================
        // 3D –§–û–ù (–ö–†–£–ñ–û–ß–ö–ò)
        // ==========================================
        function initThreeJS() {
            const canvas = document.getElementById('bg-canvas');
            const scene = new THREE.Scene();
            scene.background = new THREE.Color(0xf0f4f8); // –¶–≤–µ—Ç —Ñ–æ–Ω–∞ —Å—Ü–µ–Ω—ã

            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 5;

            const renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true, antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);

            // 1. –°–æ–∑–¥–∞–µ–º —Ç–µ–∫—Å—Ç—É—Ä—É –ö–†–£–ì–ê –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ
            function getCircleTexture() {
                const canvas = document.createElement('canvas');
                canvas.width = 32;
                canvas.height = 32;
                const ctx = canvas.getContext('2d');
                
                // –†–∏—Å—É–µ–º –±–µ–ª—ã–π –∫—Ä—É–≥
                ctx.beginPath();
                ctx.arc(16, 16, 15, 0, 2 * Math.PI);
                ctx.fillStyle = '#ffffff';
                ctx.fill();
                
                const texture = new THREE.CanvasTexture(canvas);
                return texture;
            }

            const circleTexture = getCircleTexture();

            // 2. –°–æ–∑–¥–∞–µ–º —á–∞—Å—Ç–∏—Ü—ã
            const particlesGeometry = new THREE.BufferGeometry();
            const particlesCount = 60;
            
            const posArray = new Float32Array(particlesCount * 3);
            for(let i = 0; i < particlesCount * 3; i++) {
                posArray[i] = (Math.random() - 0.5) * 15;
            }
            particlesGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));

            // –ú–∞—Ç–µ—Ä–∏–∞–ª - –ì–û–õ–£–ë–´–ï –∫—Ä—É–≥–∏
            const materialBlue = new THREE.PointsMaterial({
                size: 0.3,
                color: 0xA2D2FF,
                map: circleTexture, // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–∫—Å—Ç—É—Ä—É –∫—Ä—É–≥–∞
                transparent: true,
                opacity: 0.8,
                alphaTest: 0.1 // –£–±–∏—Ä–∞–µ–º –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ –∫—Ä–∞—è
            });

            // –ú–∞—Ç–µ—Ä–∏–∞–ª - –†–û–ó–û–í–´–ï –∫—Ä—É–≥–∏
            const materialPink = new THREE.PointsMaterial({
                size: 0.25,
                color: 0xFFC8DD,
                map: circleTexture,
                transparent: true,
                opacity: 0.8,
                alphaTest: 0.1
            });

            // –°–æ–∑–¥–∞–µ–º –¥–≤–∞ –æ–±–ª–∞–∫–∞ —Ç–æ—á–µ–∫
            const particlesMesh = new THREE.Points(particlesGeometry, materialBlue);
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≥–µ–æ–º–µ—Ç—Ä–∏—é –¥–ª—è —Ä–æ–∑–æ–≤—ã—Ö
            const particlesGeometry2 = new THREE.BufferGeometry();
            const posArray2 = new Float32Array(particlesCount * 3);
            for(let i = 0; i < particlesCount * 3; i++) posArray2[i] = (Math.random() - 0.5) * 15;
            particlesGeometry2.setAttribute('position', new THREE.BufferAttribute(posArray2, 3));
            
            const particlesMesh2 = new THREE.Points(particlesGeometry2, materialPink);
            
            scene.add(particlesMesh);
            scene.add(particlesMesh2);

            const animate = () => {
                requestAnimationFrame(animate);
                
                particlesMesh.rotation.y += 0.001;
                particlesMesh.rotation.x += 0.0005;
                
                particlesMesh2.rotation.y -= 0.0012; 
                particlesMesh2.rotation.x -= 0.0005;

                renderer.render(scene, camera);
            };

            animate();

            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });
        }

        window.onload = initThreeJS;

    </script>
</body>
</html>